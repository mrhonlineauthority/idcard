<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>M.R.H Login System</title>
  <!-- Font Awesome for Help Line Icon -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <style>
    body {
      font-family: 'Times New Roman', Times New Roman;
      margin: 0;
      background: #dfe6ed;
    }

    /* Help line icon style */
    .help-line {
      position: fixed;
      top: 15px;
      right: 15px;
      background: #d63384;
      color: white;
      padding: 10px 12px;
      border-radius: 50%;
      text-align: center;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 0 8px rgba(0,0,0,0.3);
      z-index: 1000;
    }
    .help-line:hover {
      background: #a61e63;
    }

    .login-box, #formWrapper {
      max-width: 400px;
      margin: 60px auto;
      padding: 30px;
      background: #d63384;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    .login-box h2 {
      text-align: center;
      margin-bottom: 20px;
      color: #2c3e50;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }
    input[type="text"],
    input[type="password"],
    input[type="email"],
    input[type="date"],
    input[type="file"],
    select {
      width: 95%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      background-color: #2980b9;
      color: white;
      padding: 10px;
      margin-top: 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      width: 102%;
    }
    button:hover {
      background-color: #1c5980;
    }
    #idCardWrapper { display: none; }
    #idCard {
      width: 600px;
      margin: 20px auto;
      background: white;
      padding: 20px;
      border: 2px solid #d63384;
      border-radius: 10px;
      position: relative;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    .card-photo {
      width: 150px;
      height: 180px;
      object-fit: cover;
      border: 2px solid #ccc;
      float: right;
      margin-left: 20px;
    }
    .card-info { overflow: hidden; }
    .print-btn {
      background: green;
      color: white;
      margin-top: 20px;
      padding: 10px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
    }

    @media print {
      body * { visibility: hidden; }
      #idCardWrapper, #idCardWrapper * {
        visibility: visible;
      }
      #idCardWrapper {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        margin: 0;
        padding: 0;
      }
      #idCard {
        box-shadow: none;
        border: 2px solid #000;
        page-break-after: avoid;
      }
    }
  </style>
</head>
<body>

<!-- Help Line Icon -->
<a href="https://mrhonlineauthority.github.io/mrhhelplinehome/" class="help-line" title="Help Line">
  <i class="fas fa-headset"></i>
</a>

<!-- Login Panel -->
<div class="login-box" id="loginBox">
  <h2>M.R.H LOGIN</h2>
  <label>Entry ID</label>
  <input type="text" id="loginID" placeholder="Enter Entry ID" required>
  <label>Password</label>
  <input type="password" id="loginPass" placeholder="Enter Password" required>
  <button onclick="checkLogin()">Sign In</button>
</div>

<!-- ID Card Entry Form -->
<div id="formWrapper" style="display:none;">
  <form id="entryForm">
    <h2>M.R.H AUTHORITY ID CARD</h2>
    <label>Name</label><input type="text" id="name" required />
    <label>Nationality</label><input type="text" id="nationality" required />
    <label>Religion</label><input type="text" id="religion" required />
    <label>Division</label><input type="text" id="division" required />
    <label>District</label><input type="text" id="district" required />
    <label>Upazila</label><input type="text" id="upazila" required />
    <label>Email</label><input type="email" id="email" required />
    <label>Date Of Birth</label><input type="date" id="dob" required />
    <label>Picture</label><input type="file" id="photo" accept="image/*" required />
    <button type="submit">Submit</button>
  </form>
</div>

<!-- ID Card Output -->
<div id="idCardWrapper">
  <div id="idCard">
    <h3 style="text-align:center; color:#d63384;">M.R.H ONLINE E-REGISTRATION AUTHORITY</h3>
    <h3 style="text-align:center; color:#d63384;">M.R.H ID VERIFY</h3>
    <div class="card-content">
      <img id="cardPhoto" class="card-photo" />
      <div class="card-info">
        <p><strong>Name:</strong> <span id="cardName"></span></p>
        <p><strong>Nationality:</strong> <span id="cardNationality"></span></p>
        <p><strong>Religion:</strong> <span id="cardReligion"></span></p>
        <p><strong>Division</strong> <span id="cardDivision"></span></p>
        <p><strong>District</strong> <span id="cardDistrict"></span></p>
        <p><strong>Upazila:</strong> <span id="cardUpazila"></span></p>
        <p><strong>Email</strong> <span id="cardEmail"></span></p>
        <p><strong>Date Of Birth:</strong> <span id="cardDOB"></span></p>
        <p><strong>ID No:</strong> <span id="cardReg"></span></p>
        <p><strong>Expire Date:</strong> <span id="cardExpire"></span></p>
      </div>
    </div>
    <button class="print-btn" onclick="printIDCard()">Print</button>
  </div>
</div>

<script>
  function checkLogin() {
    const id = document.getElementById("loginID").value;
    const pass = document.getElementById("loginPass").value;
    if (id === "832091" && pass === "34021867") {
      document.getElementById("loginBox").style.display = "none";
      document.getElementById("formWrapper").style.display = "block";
    } else {
      alert("ভুল Entry ID অথবা Password!");
    }
  }

  function generateKey(obj) {
    return `${obj.name}_${obj.nationality}_${obj.religion}_${obj.division}_${obj.district}_${obj.upazila}_${obj.email}_${obj.dob}`;
  }

  document.getElementById("entryForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const formData = {
      name: document.getElementById("name").value.trim(),
      nationality: document.getElementById("nationality").value.trim(),
      religion: document.getElementById("religion").value.trim(),
      division: document.getElementById("division").value.trim(),
      district: document.getElementById("district").value.trim(),
      upazila: document.getElementById("upazila").value.trim(),
      email: document.getElementById("email").value.trim(),
      dob: document.getElementById("dob").value
    };

    const photo = document.getElementById("photo").files[0];
    const key = generateKey(formData);

    let reg, expireDate;
    const today = new Date();

    if (localStorage.getItem(key)) {
      const saved = JSON.parse(localStorage.getItem(key));
      reg = saved.reg;

      if (saved.expire && new Date(saved.expire) > today) {
        expireDate = saved.expire;
      } else {
        const newExpiry = new Date();
        newExpiry.setFullYear(newExpiry.getFullYear() + 1);
        expireDate = newExpiry.toISOString().split("T")[0];
        localStorage.setItem(key, JSON.stringify({ ...formData, reg, expire: expireDate }));
      }
    } else {
      reg = Math.floor(1000000000000000 + Math.random() * 9000000000000000);
      const newExpiry = new Date();
      newExpiry.setFullYear(newExpiry.getFullYear() + 1);
      expireDate = newExpiry.toISOString().split("T")[0];
      localStorage.setItem(key, JSON.stringify({ ...formData, reg, expire: expireDate }));
    }

    const reader = new FileReader();
    reader.onload = function(e) {
      document.getElementById("cardPhoto").src = e.target.result;
    };
    reader.readAsDataURL(photo);

    document.getElementById("cardName").textContent = formData.name;
    document.getElementById("cardNationality").textContent = formData.nationality;
    document.getElementById("cardReligion").textContent = formData.religion;
    document.getElementById("cardDivision").textContent = formData.division;
    document.getElementById("cardDistrict").textContent = formData.district;
    document.getElementById("cardUpazila").textContent = formData.upazila;
    document.getElementById("cardEmail").textContent = formData.email;
    document.getElementById("cardDOB").textContent = formData.dob;
    document.getElementById("cardReg").textContent = reg;
    document.getElementById("cardExpire").textContent = expireDate;

    document.getElementById("formWrapper").style.display = "none";
    document.getElementById("idCardWrapper").style.display = "block";
  });

  function printIDCard() {
    window.print();
  }
</script>
</body>
</html>
